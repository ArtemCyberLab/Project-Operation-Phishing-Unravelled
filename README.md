I, as an IT department personnel at SwiftSpend Financial, took on the investigation of a phishing attack that impacted several colleagues. I began by analyzing suspicious emails and discovered that one email with a PDF attachment was sent to William McClean, while the phishing emails originated from the address Accounts.Payable@groupmarketingonline.icu. Next, I examined the email for Zoe Duncan, saved the attached .html file, opened it in a text editor, and copied the redirection URL (without quotes or apostrophes). Using CyberChef and the “Defang URL” operation, I obtained the defanged URL: hxxp[://]kennaroads[.]buzz/data/Update365/office365/40e7baa2f826a57fcf04e5202526f8bd/?email=zoe[.]duncan@swiftspend[.]finance&error.

Noticing that the URL directed to the domain kennaroads.buzz, I navigated to the /data directory, found the zip archive of the phishing kit, copied its URL, and defanged it via CyberChef to get hxxp[://]kennaroads[.]buzz/data/Update365[.]zip. After downloading the archive to my virtual machine, I calculated its SHA256 hash using the command “sha256sum Update365.zip” and then verified on VirusTotal that the archive was first submitted on 2020–04–08 21:55:50 UTC. Further investigation on VirusTotal revealed that the domain’s Creation Date is 2023-07-16.

Delving deeper into the domain’s content, I discovered a file containing stolen credentials, where I identified that the user michael.ascot@swiftspend.finance submitted their password twice. Additionally, by inspecting the “submit.php” file within the archive, I found the email address used by the adversary to collect the compromised credentials – m3npat@yandex.com. Using the grep command to search recursively for the string “@gmail.com” in the archive, I uncovered the address jamestanner2299@gmail.com.

Finally, by manually brute-forcing the URL kennaroads.buzz/data/Update365/office365/flag.txt, I retrieved a string that appeared to be Base64-encoded. I decoded this string using CyberChef and then applied the “reverse” operation to reveal the final hidden flag: THM{pL4y_w1Th_tH3_URL}.
